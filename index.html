<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapa Payment Integration</title>
</head>
<body>

    <h2>Initiate Payment with Chapa</h2>
    <button id="payButton">Pay Now</button>

    <script>
        document.getElementById('payButton').addEventListener('click', function() {
            // Prepare headers
            var myHeaders = new Headers();
            myHeaders.append("Authorization", "CHAPUBK_TEST-EBc3V7UcU02MoDUrNRYXOl4iNcdNoinK);
            myHeaders.append("Content-Type", "application/json");

            // Prepare the request body
            var raw = JSON.stringify({
                "amount": "10",
                "currency": "ETB",
                "email": "abebech_bekele@gmail.com",
                "first_name": "Bilen",
                "last_name": "Gizachew",
                "phone_number": "0912345678",
                "tx_ref": "chewatatest-6669",
                "callback_url": "https://webhook.site/077164d6-29cb-40df-ba29-8a00e59a7e60",
                "return_url": "https://www.google.com/",
                "customization[title]": "Payment for my favourite merchant",
                "customization[description]": "I love online payments",
                "meta[hide_receipt]": "true"
            });

            // Configure request options
            var requestOptions = {
                method: 'POST',
                headers: myHeaders,
                body: raw,
                redirect: 'follow'
            };

            // Send the POST request to the Chapa API
            fetch("https://api.chapa.co/v1/transaction/initialize", requestOptions)
                .then(response => response.json())  // Parsing response as JSON
                .then(result => {
                    // Log the response to the console (you can display it or handle accordingly)
                    console.log(result);

                    // If the transaction is successful, redirect to the payment page
                    if (result.status === "success") {
                        window.location.href = result.payment_url;  // Redirect user to Chapa payment page
                    } else {
                        alert('Payment Initialization Failed: ' + result.message);
                    }
                })
                .catch(error => {
                    console.log('Error:', error);
                    alert('An error occurred. Please try again.');
                });
        });
    </script>

</body>
</html>
